{{- define "services" -}}
  <mj-accordion border="1px" icon-wrapped-url="http://i.imgur.com/Xvw0vjq.png" icon-unwrapped-url="http://i.imgur.com/KKHenWa.png" icon-height="24px" icon-width="24px">
    {{- range $index, $service := . -}}
      <mj-accordion-element>
        <mj-accordion-title font-size="24px">
          {{- if eq $service.state "healthy" -}}
            âœ…
          {{- else if eq $service.state "unhealthy" -}}
            ðŸ”´
          {{- end -}}Â {{- $service.name -}}
        </mj-accordion-title>

        <mj-accordion-text background-color="#f5f5f5">
            ID:Â <span style="font-family: 'Courier new';">{{- $service.containerId -}}</span>
            <br />
            Image:Â <span style="font-family: 'Courier new';">{{- $service.imageName -}}</span>
        </mj-accordion-text>

        <mj-accordion-text background-color="#f5f5f5" padding="0px 0px 8px 16px">
          <strong>Logs</strong>
        </mj-accordion-text>

        <mj-accordion-text background-color="#3a3a3a" color="#f8f8f8" font-size="10px" font-family="Courier new">
          {{- range $log := $service.logs -}}
            {{- $log -}}</br>
          {{- end -}}
        </mj-accordion-text>

        {{- if $service.healthLogs }}
          <mj-accordion-text background-color="#f5f5f5" padding="8px 0px 8px 16px">
            <strong>Healthcheck logs</strong>
          </mj-accordion-text>

          <mj-accordion-text background-color="#3a3a3a" color="#f8f8f8" font-size="10px" font-family="Courier new">
            {{- range $log := $service.healthLogs -}}
              {{- $log -}}</br>
            {{- end -}}
          </mj-accordion-text>
        {{- end -}}
      </mj-accordion-element>
    {{- end -}}
  </mj-accordion>
{{- end -}}

<mjml>
  <mj-body background-color="#e1e1e8">
    <mj-spacer height="40px"></mj-spacer>

    <mj-section background-color="#3a3a3a">
      <mj-column>
        <mj-text align="center" color="#f8f8f8" padding="0" font-size="24px" font-weight="bold">Dashboard</mj-text>
      </mj-column>
    </mj-section>

    <mj-section background-color="#ffffff">
      <mj-column>
        <mj-text align="center">
          <h1>
            {{- if .success -}}
              <span style="color: #4cae4c;">Successful</span>
            {{- else -}}
              <span style="color: #ff6347;">Failed</span>
            {{- end -}}
            &nbsp;deploy of <a href="{{- .url -}}/?filter={{- .app -}}" rel="noreferrer noopener" target="_blank">
            <strong>{{- .app -}}</strong>
          </h1>
        </mj-text>

        {{- template "services" .services -}}
      </mj-column>
    </mj-section>

    {{- template "footer" -}}

    <mj-spacer height="40px"></mj-spacer>
  </mj-body>
</mjml>
